# SYNTAX TEST "source.trilogy" "datasource syntax highlighting"

# Test 1: Verbose datasource assignment with modifiers
datasource raw_launch_info (
# <-----  storage.type.function.trilogy
    Launch_Tag: launch_tag,
    LV_Type: ~vehicle.name,
#            ^ keyword.operator.modifier.trilogy
    Platform: ~?platform.code,
#             ^^ keyword.operator.modifier.trilogy
    FailCode: ?fail_code,
#             ^ keyword.operator.modifier.trilogy
    )
grain (launch_tag)
# <--  keyword.control.trilogy
file ingest_launch.py;

# Test 2: Simple datasource assignment with modifiers (no field mapping)
datasource launch_info (
# <-----  storage.type.function.trilogy
    launch_tag,
    ~vehicle.name,
#   ^ keyword.operator.modifier.trilogy
    ~vehicle.variant,
#   ^ keyword.operator.modifier.trilogy
    ~?platform.code,
#   ^^ keyword.operator.modifier.trilogy
    ~?site.key,
#   ^^ keyword.operator.modifier.trilogy
    ?fail_code,
#   ^ keyword.operator.modifier.trilogy
    data_updated_through
    )
grain (launch_tag)
# <--  keyword.control.trilogy
file `gcs://trilogy_public_models/duckdb/launch_report/launch.parquet`
# <-  keyword.control.trilogy
freshness by data_updated_through;
# <------  keyword.control.trilogy
#         ^^ keyword.control.trilogy
#            ^ variable.other.field.trilogy

# Test 3: Mixed verbose and simple assignments
datasource mixed_example (
    id: primary_id,
    ~nested.field,
#   ^ keyword.operator.modifier.trilogy
    status: ~?optional.status,
#           ^^ keyword.operator.modifier.trilogy
    ?nullable_field
#   ^ keyword.operator.modifier.trilogy
    )
grain (id)
file example.csv;
